<%- model_class = @bike.class -%>


<%= render "send_to_friend_modal"%>
<div class = "row">
  <div class = "span3">
    
    <div class = "toolbox">
      <legend>Toolbox</legend>
     <i class = " icon-chevron-left"> </i> <%= link_to " Back to search", bikes_path(sort: params[:sort], :direction => params[:direction], type: params[:type],body: params[:body], make: params[:make], model: params[:model], color: params[:color], location: params[:location])%>
      <div class = "save_search">
        <% if current_user and current_user.favourites.where(bike_id: @bike.id).empty?%>
          <i class = "icon-star"></i><a id= "save_search"> Save Search</a>
        <%elsif !current_user%>
         <i class = "icon-star"></i>
          <a href="#" data-toggle="tooltip" title="Sign in First">Save Search</a>
        <%else%>
          Saved
        <%end%>
      </div>
      <i class= "icon-envelope"></i><a href="#send_to_friend" data-toggle="modal"> Send to Friend</a>


    </div>
    <%=render "current_selection"%>
  </div>

  <div class = "span6" id= "bike_info">
    <div class="show-page-header">
  <%= link_to "Previous", bike_path(@previous_bike, sort: params[:sort], :direction => params[:direction], body: params[:body], make: params[:make], model: params[:model], color: params[:color],type: params[:type]),  id: "previous",class:"btn btn-primary" if @previous_bike!= @bike%>

  

      <%= link_to "Next", bike_path(@next_bike, sort: params[:sort], :direction => params[:direction], body: params[:body], make: params[:make], model: params[:model], color:params[:color],type: params[:type]),class:"btn btn-primary" if !@next_bike.nil?%>
     <%= @bike.year %>  <%= @bike.make %>  <%= @bike.model %>  <%= @bike.variant if !@bike.variant.nil? %>
</div>
  <div class="fb-like" data-send="true" data-layout="button_count" data-width="45" data-show-faces="false"></div><a id = "share">
  Share on Facebook
</a>
    <div class = "picture">
      <%= image_tag @bike.pictures.last.file.url(:original), id: "bike_picture" if !@bike.pictures.empty? %>
    </div>
    
    <% if !@bike.pictures.empty?%>

      <ul class = "image_list">
      <%@bike.pictures.each do |image| %>
      <li><%= image_tag image.file.url(:thumb), id: image.id %></li>
      <% end %>
      </ul>
    <%end%>
    <div class = "result">
    <legend>
      Bike Details
    </legend>

      <table class= "table"><tr>

        <td>Bike:<td> 
          <td><%=@bike.model%></td>
        </tr>
        <tr>

        <td>Make:<td> 
          <td><%=@bike.make%></td>
        </tr>
        <tr>


        <td>Type:<td> 
          <td><%=@bike.type%></td>
        </tr>
        <tr>

        <td>Price:<td> 
          <td><%=@bike.price%></td>
        </tr>
        <tr>

        <td>Variant:<td> 
          <td><%=@bike.variant%></td>
        </tr>
        <tr>

        <td>Year:<td> 
          <td><%=@bike.year%></td>
        </tr>
        <tr>
         
      </table>
  </div>
  </div>

  <div class = "span3">
    <%= render "enquiry"%>

  </div>
</div>
<div class = "row">
  <div class=  "span3"></div>
  <div class="span6" id= "bike_spec_span_padding">
<div class="span12" id= "bike_spec_span">
  <legend>
    <a href="<%bikes_path(@bike)%>" data-remote="true" id="more">Bike Info <i class= "icon-chevron-down"> </i></a>
    <a id = "less"> Bike Info <i class= "icon-chevron-down"> </i><i class= "icon-chevron-up"> </i></a>
  </legend>
</div>
</div>
</div>
<% if @bike.user==current_user%>
<div class="form-actions">
  <%= link_to t('.back', :default => t("helpers.links.back")),
              bikes_path, :class => 'btn'  %>
  <%= link_to t('.edit', :default => t("helpers.links.edit")),
              edit_bike_path(@bike), :class => 'btn' %>
  <%= link_to t('.destroy', :default => t("helpers.links.destroy")),
              bike_path(@bike),
              :method => 'delete',
              :confirm => t('.confirm', :default => t("helpers.links.confirm", :default => 'Are you sure?')),
              :class => 'btn btn-danger' %>
  
  </div>
<%end%>
    
<script type="text/javascript">
//<![CDATA[
$("document").ready(function() {
  $('a#less').hide();
});



$('a#more').click(function(){
$('a#more').hide();
$('a#less').show();
$('i.icon-chevron-down').hide();
  
});
$('a#less').click(function(){

});

$('a#save_search').click(function(){

  $.ajax({
    url: "<%=save_search_bikes_path%>",
    data: {id: "<%=@bike.id%>" },
    success:console.log("test"),
  })
});

$("form#send_to_friend").submit(function(event) {
  
  
  console.log( $("form#send_to_friend").serialize() )
  $.ajax({
    url: "<%=send_to_friend_bikes_path%>",
    data: $("form#send_to_friend").serialize(),
    success:console.log("test"),
  });

  $("#send_to_friend").modal('hide');
  return false

});

$('ul.image_list li').hover(function() {

  
  var id= "<%=@bike.id%>";
  var pic_id = $(':first-child', this).attr("id");

  $.ajax({
                url: "<%=change_picture_bikes_path%>",
               
                
                data: {id: id, pic_id: pic_id },
                 success:console.log("test"),

             });
});
    // insert teh codez
$('a#share').click(function(){

  var sharer = "https://www.facebook.com/sharer/sharer.php?u=";
window.open(sharer + location.href, 'sharer', 'width=626,height=436');
});
//]]>

</script>
